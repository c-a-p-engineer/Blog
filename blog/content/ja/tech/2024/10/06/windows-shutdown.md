---
title: Windowsで一定時間後に自動的にシャットダウン・再起動・スリープを行う方法
date: 2024-10-06T03:00:00+09:00
description: Windowsでは、コマンドプロンプトを使って簡単にシャットダウン、再起動、スリープをタイマーで設定することが可能です。
draft: false
enableToc: true
enableTocContent: true
tags: 
- Windows
categories: 
- Windows
image: images/thumbnail/hacker_tool.jpg
---
# Windowsで一定時間後に自動的にシャットダウン・再起動・スリープを行う方法

Windowsでは、コマンドプロンプトを使って簡単にシャットダウン、再起動、スリープをタイマーで設定することが可能です。Windows 10およびWindows 11に対応した方法を詳しく紹介します。
カウントダウン表示やコマンドのキャンセル方法も解説しますので、ぜひ参考にしてください。

## 対象環境
- **OS**: Windows 10, Windows 11
- **コマンド使用環境**: コマンドプロンプト（管理者権限が推奨）

## シャットダウンを一定時間後に自動実行する方法

まず、コマンドプロンプトを開いて次のコマンドを実行します。`/t`オプションでシャットダウンまでの待ち時間を秒単位で指定できます。

### コマンド例

```bash
shutdown /s /t <秒数>
```

- `/s`: シャットダウンを実行
- `/t <秒数>`: 指定時間後にシャットダウンを実行

### 具体例

たとえば、30分（1800秒）後にPCを自動的にシャットダウンする場合は次のコマンドを使用します。
```bash
shutdown /s /t 1800
```

## 再起動を一定時間後に実行する方法

再起動をタイマー設定する場合も、`shutdown`コマンドに`/r`オプションを付けることで簡単に設定できます。

### コマンド例

```bash
shutdown /r /t <秒数>
```

- `/r`: 再起動を実行
- `/t <秒数>`: 指定時間後に再起動を実行

### 具体例
10分（600秒）後に再起動する場合のコマンドは次の通りです。
```bash
shutdown /r /t 600
```

## スリープを一定時間後に実行する方法

スリープに関しては`shutdown`コマンドでは直接対応していないため、`rundll32.exe`を利用します。このコマンドを使うと、指定時間後にPCをスリープ状態にすることが可能です。

### コマンド例

```bash
timeout /t <秒数> && rundll32.exe powrprof.dll,SetSuspendState 0,1,0
```

- `timeout /t <秒数>`: 指定時間後に待機
- `rundll32.exe powrprof.dll,SetSuspendState 0,1,0`: スリープを実行

### 具体例

1時間（3600秒）後にPCをスリープ状態にする場合のコマンドは以下の通りです。
```bash
timeout /t 3600 && rundll32.exe powrprof.dll,SetSuspendState 0,1,0
```

## カウントダウンの表示方法

シャットダウンまでの時間をカウントダウン表示させるには、次のコマンドを使用します。これにより、1秒ごとにカウントダウンを行い、残り時間が表示されます。

### コマンド例
```bash
for /l %i in (<開始秒数>,-1,1) do (echo %i & timeout /t 1)
```

**例**: 10秒のカウントダウンを表示させる場合
```bash
for /l %i in (10,-1,1) do (echo %i & timeout /t 1)
```

## シャットダウンのキャンセル方法

設定したシャットダウンや再起動をキャンセルしたい場合は、次のコマンドを実行します。

### コマンド例

```bash
shutdown /a
```

- `/a`: 現在のシャットダウンをキャンセル

### 注意点

一度タイマーが設定されると、変更はできません。変更する場合は、まずキャンセルを実行し、再度新しいタイマーを設定する必要があります【13†source】【14†source】。

## まとめ

Windowsで一定時間後にシャットダウン、再起動、スリープを自動で行う方法は、コマンドプロンプトを使えば非常に簡単に設定できます。とくに`shutdown`コマンドを活用すれば、手軽にPCの電源管理を行うことが可能です。各コマンドはキャンセルもできるため、柔軟に操作できます。

### 参考URL

<a href="https://learn.microsoft.com/ja-jp/windows-server/administration/windows-commands/shutdown" target="_blank" rel="nofollow noopener">shutdown</a>

これで、効率的にPCのシャットダウンやスリープを管理できますので、ぜひお試しください！
